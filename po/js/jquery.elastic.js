(function(i){i.fn.extend({elastic:function(){var j=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight","border-top-width","border-right-width","border-bottom-width","border-left-width","borderTopStyle","borderTopColor","borderRightStyle","borderRightColor","borderBottomStyle","borderBottomColor","borderLeftStyle","borderLeftColor"];return this.each(function(){function m(){curatedWidth=Math.floor(parseInt(a.width(),10));if(b.width!=curatedWidth){b.css({width:curatedWidth+ "px"});e(true)}}function k(c,f){curratedHeight=Math.floor(parseInt(c,10));if(a.height()!=curratedHeight){a.css({height:curratedHeight+"px",overflow:f});a.trigger("resize")}}function e(c){var f=a.val().replace(/&/g,"&amp;").replace(/ /g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />"),n=b.html().replace(/<br>/ig,"<br />");if(c||f+"&nbsp;"!=n){b.html(f+"&nbsp;");if(Math.abs(b.height()+l-a.height())>3){c=b.height()+l;if(c>=d)k(d,"auto");else c<=g?k(g,"hidden"):k(c,"hidden")}}}if(this.type!= "textarea")return false;var a=i(this),b=i("<div />").css({position:"absolute",display:"none","word-wrap":"break-word"}),l=parseInt(a.css("line-height"),10)||parseInt(a.css("font-size"),"10"),g=parseInt(a.css("height"),10)||l*3,d=parseInt(a.css("max-height"),10)||Number.MAX_VALUE,h=0;if(d<0)d=Number.MAX_VALUE;b.appendTo(a.parent());for(h=j.length;h--;)b.css(j[h].toString(),a.css(j[h].toString()));a.css({overflow:"hidden"});a.bind("keyup change cut paste",function(){e()});$(window).bind("resize",m); a.bind("resize",m);a.bind("blur",function(){if(b.height()<d)b.height()>g?a.height(b.height()):a.height(g)});a.bind("input paste",function(){setTimeout(e,250)});e()})}})})(jQuery)